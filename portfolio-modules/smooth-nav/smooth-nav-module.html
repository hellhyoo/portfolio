<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Module</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:opsz,wght@6..144,1..1000&family=Noto+Sans+JP:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        /* Variables */
        :root {
            --color-bg: #0c0a09;
            --color-text: #a3a3a3;
            --color-text-bright: #fff;
            --color-accent: #e7ffb0;
            
            --accent-1: #d8005f;
            --accent-2: #08c291;
            --accent-3: #0091ff;
            --accent-4: #d92641;
            --accent-5: #0cac44;
            --accent-6: #ffbb00;
            --accent-7: #f06800;
            --accent-8: #b55af2;
            --accent-9: #e878b4;
            --accent-10: #bfa892;
            --accent-11: #0eb8cd;
            
            --font-family: 'Google Sans Flex', 'Noto Sans JP', sans-serif;
            --transition-smooth: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Navigation Styles */
        .smooth-nav {
            position: fixed;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            display: inline-flex;
            justify-content: center;
            background: transparent;
            backdrop-filter: blur(5px) brightness(0.9);
            -webkit-backdrop-filter: blur(5px) brightness(0.9); /* Safari */
            border-radius: 50px;
            padding: 0.25rem 0.8rem;
            box-shadow: 0 4px 16px rgba(231, 255, 176, 0.5);
            z-index: 1000;
        }
        
        .smooth-nav-link {
            position: relative;
            color: var(--color-text-bright);
            font-size: 0.85rem;
            font-weight: 400;
            text-decoration: none;
            padding: 0.4rem 0.8rem;
            border-radius: 50px;
            z-index: 2;
            transition: color 0.3s ease;
        }
        
        .smooth-nav-link.active {
            color: var(--color-accent);
        }
        
        .smooth-nav-indicator {
            position: absolute;
            background: rgba(231, 255, 176, 0.1);
            border-radius: 50px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            opacity: 0;
            z-index: 1;
            box-sizing: border-box;
        }
        
        .smooth-nav-indicator.active {
            opacity: 1;
        }
    </style>
</head>
<body>

    <!-- Разметка навигации -->
    <nav class="smooth-nav">
        <div class="smooth-nav-indicator"></div>
        <a class="smooth-nav-link" href="#hero" data-section="hero">自己紹介</a>
        <a class="smooth-nav-link" href="#school-works" data-section="school-works">作品</a>
        <a class="smooth-nav-link" href="#pet-projects" data-section="pet-projects">自主制作</a>
    </nav>

    <script>
        (function() {
            'use strict';
            // Модуль Навигации
            const SmoothNav = {
                activeLink: null,
                
                init() {
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', () => this.setup());
                    } else {
                        this.setup();
                    }
                },
                
                setup() {
                    const nav = document.querySelector('.smooth-nav');
                    const indicator = document.querySelector('.smooth-nav-indicator');
                    
                    if (!nav || !indicator) return;
                    
                    const links = document.querySelectorAll('.smooth-nav-link');
                    
                    // Hover-эффект - только индикатор
                    links.forEach(link => {
                        link.addEventListener('mouseenter', () => {
                            this.updateIndicator(link, nav, indicator);
                            indicator.classList.add('active');
                        });
                        
                        // Плавный скролл при клике
                        link.addEventListener('click', (e) => {
                            const sectionId = link.dataset.section;
                            if (sectionId) {
                                e.preventDefault();
                                this.scrollToSection(sectionId);
                            }
                        });
                    });
                    
                    // При уходе мыши - убрать индикатор
                    nav.addEventListener('mouseleave', () => {
                        indicator.classList.remove('active');
                    });
                    
                    // Отслеживать текущую секцию при скролле
                    this.observeSections();
                },
                
                updateIndicator(link, nav, indicator) {
                    const linkRect = link.getBoundingClientRect();
                    const navRect = nav.getBoundingClientRect();
                    
                    Object.assign(indicator.style, {
                        left: `${linkRect.left - navRect.left}px`,
                        top: `${linkRect.top - navRect.top}px`,
                        width: `${linkRect.width}px`,
                        height: `${linkRect.height}px`
                    });
                },
                
                scrollToSection(sectionId) {
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                },
                
                observeSections(nav, indicator) {
                    const sections = document.querySelectorAll('section[id]');
                    const options = {
                        rootMargin: '-50% 0px -50% 0px',
                        threshold: 0
                    };
                    
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                this.setActiveLink(entry.target.id, nav, indicator);
                            }
                        });
                    }, options);
                    
                    sections.forEach(section => observer.observe(section));
                },
                
                setActiveLink(sectionId) {
                    const link = document.querySelector(`[data-section="${sectionId}"]`);
                    
                    if (link && link !== this.activeLink) {
                        // Убрать активный класс у предыдущей ссылки
                        if (this.activeLink) {
                            this.activeLink.classList.remove('active');
                        }
                        
                        // Добавить к новой - только класс для цвета текста
                        link.classList.add('active');
                        this.activeLink = link;
                        
                        // НЕ трогаем индикатор - он управляется только hover
                    }
                }
            };
            // Инициализация
            SmoothNav.init();
        })();
    </script>
</body>
</html>